"""
Модуль для загрузки обученной модели YOLOv8.

Задача модуля — максимально просто и понятно:
- проверить, что файл модели действительно существует;
- загрузить модель через библиотеку ultralytics;
- в случае ошибки вывести сообщение и корректно завершить программу.
"""

from __future__ import annotations

import os
import sys

from ultralytics import YOLO


def load_model(model_path: str = "models/model.pt") -> YOLO:
    """
    Загружает обученную модель YOLOv8 из файла.

    Параметры:
        model_path: путь к файлу модели (обычно .pt).

    Возвращает:
        Загруженный объект модели YOLO.

    Важно:
        Если файла нет или загрузка не удалась — выводим понятное сообщение
        и завершаем программу с кодом ошибки (1).
    """

    # 1) Проверяем, существует ли файл модели.
    # Если файла нет, дальше продолжать бессмысленно — приложение работать не сможет.
    if not os.path.exists(model_path):
        print(f"Ошибка: файл модели не найден: {model_path}")
        print("Проверьте, что модель обучена и сохранена в папку models/.")
        sys.exit(1)

    # 2) Пытаемся загрузить модель через ultralytics.YOLO.
    # Оборачиваем в try/except, чтобы при ошибке показать сообщение пользователю.
    try:
        model = YOLO(model_path)
        return model
    except Exception as exc:
        print("Ошибка: не удалось загрузить модель YOLOv8.")
        print(f"Путь к модели: {model_path}")
        print(f"Текст ошибки: {exc}")
        sys.exit(1)

